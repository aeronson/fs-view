/* Component styles for player */

:host {
  display: block;
}

.main {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  margin-top: var(--top-margin, 20px);
  height: calc(100vh - var(--top-margin, 20px));
  gap: var(--gutter, 1rem);
  box-sizing: border-box;
  min-height: 0;
}

.video-block {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  gap: var(--gutter, 1rem);
}

.file-block {
  width: 10rem;
  display: flex;
  flex-direction: column;
  gap: var(--gutter, 1rem);
  min-height: 0;
  padding: 0.5rem;
}

.file-input-block {
  display: flex;
  flex-direction: column; /* stack button and input */
  width: 100%;
  box-sizing: border-box;
  column-gap: var(--gutter, 1rem);
  row-gap: 0.5rem;
  row-gap: 0; /* controls sit directly over the slider */
  padding: 0 0.25rem; /* added padding for formatting */
}
/* display: contents; was previous attempt; not required in flex layout */
.video-controls-block {
  display: flex;
  flex-direction: column;
  align-items: center; /* center in horizontal mode */
  gap: 0.25rem;
}

.file-list {
  margin-top: 10px;
  width: 100%;
  box-sizing: border-box;
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: auto;
  padding: 0 0.25rem;
  min-height: 0;
}

/* Removed duplicated .video-block definition (we use the one above for horizontal layout) */

.video-container-block {
  width: 100%;
  max-width: 100%;
  margin: 0 auto;
  flex: unset;
  min-height: clamp(180px, 40vh, var(--video-size, 600px));
  aspect-ratio: var(--video-aspect, 16/9);
  background: var(--bg, #000);
  position: relative;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  max-height: 90vh;
}

/* grid area assignments */
.video-container-block { order: 0; flex: 1 1 auto; }
.video-controls { order: 1; }
.slider { order: 2; align-self: stretch; width: 100%; }
.chart-block { order: 3; }

/* Ensure the video fits within the container and maintains aspect ratio */
.video-container-block video {
  width: 100%;
  height: 100%;
  max-width: 100%;
  max-height: 100%;
  object-fit: contain; /* keep aspect ratio and letterbox if needed */
  object-position: center center;
  display: block;
}

.video-container-block.zoom video {
  object-fit: cover; /* Zoom mode: fill container, crop as needed */
}

.video-controls {
  display: flex;
  gap: 10px;
  justify-content: center; /* center by default in horizontal mode */
  align-items: center;
  min-height: var(--controls-height, 48px);
  width: 100%;
  position: relative;
  flex: unset;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(2px);
  z-index: 10;
  padding: 0.25rem 0.5rem;
  margin-bottom: 0;
  align-self: center;
}

/* fixture badge removed (no fixtures UI) */

.chart-block {
  width: 100%;
  margin-top: 8px;
  height: var(--chart-height, 100px);
  min-height: var(--chart-height, 100px);
  flex: unset;
}

.chart-block canvas {
  width: 100%;
  height: 100%;
  display: block;
}

/* Vertical layout: place video on left and controls/slider/chart stacked on right */
.video-block.vertical {
  flex-direction: row; /* video left, controls & others stacked on the right */
  align-items: stretch;
  width: 100%;
}

/* In vertical (portrait) mode, let the video container fill the full available height
   so tall videos scale to the maximum vertical area. Remove aspect ratio so the
   container can scale to height, and ensure the video fills height with width auto. */
.video-block.vertical .video-container-block {
  flex: 0 1 60%; /* video takes approx 60% in vertical mode */
  min-width: 40%;
  height: 100%;
  min-height: 0;
  max-height: 100%;
  aspect-ratio: auto; /* let the height determine width */
  max-width: none;
}
.video-block.vertical .video-container-block video {
  width: auto;
  height: 100%;
  object-fit: contain; /* letterbox if necessary, fill height */
}

/* Keep controls centered in horizontal layout left column */
.video-controls { padding: 0.5rem; }

/* In vertical layout, align controls to top of the right column */
.video-block.vertical .video-controls-block {
  align-items: flex-start; /* stack controls at top of right column in vertical mode */
  justify-content: flex-start;
  align-self: flex-start;
  width: auto;
  max-width: none;
  flex: 1 1 auto; /* expand to fill remaining width */
  min-width: 220px;
}
/* Ensure right column doesn't take more than 50% so video has room on narrow screens */
.video-block.vertical .video-controls-block {
  max-width: 60vw; /* ensure right column remains usable but can expand */
}

.slider {
  width: 100%;
  padding: 0 0.25rem; /* reduce vertical padding */
  margin-top: 0;
}

.chart-placeholder {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  color: rgba(255,255,255,0.6);
  font-size: 0.9rem;
  pointer-events: none;
}

/* Place the video placeholder spinner */
.video-container-block.loading::after {
  content: "";
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: 3px solid rgba(255,255,255,0.15);
  border-top-color: rgba(255,255,255,0.6);
  animation: spin 1s linear infinite;
  position: absolute;
}
@keyframes spin { to { transform: rotate(360deg); } }
